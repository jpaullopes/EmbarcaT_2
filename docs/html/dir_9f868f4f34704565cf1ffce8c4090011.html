<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Atividade_Embarca_2: Referência do diretório servidor_railway</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Atividade_Embarca_2
   </div>
   <div id="projectbrief">Um projeto que usa a BitDogLab para coletar dados como mvimentos do joystick, butões e temperatura para envio para a nuvem</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Busca" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Gerado por Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dir_9f868f4f34704565cf1ffce8c4090011.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Carregando...</div>
<div class="SRStatus" id="Searching">Procurando...</div>
<div class="SRStatus" id="NoMatches">Nenhuma entrada encontrado</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Referência do diretório servidor_railway</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Arquivos</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top"><span class="icondoc"></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8py.html">app.py</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Descrição detalhada</h2>
<p>Este documento descreve a aplicação do servidor backend construída com Python e Flask, responsável por receber dados dos dispositivos Raspberry Pi Pico W e transmiti-los em tempo real para os dashboards web.</p>
<h1><a class="anchor" id="sumário-1"></a>
Sumário</h1>
<ol type="1">
<li><a class="el" href="C:/Atividade2EBT/servidor_railway/README.md#autotoc_md1-visão-geral">Visão Geral</a></li>
<li><a class="el" href="C:/Atividade2EBT/servidor_railway/README.md#autotoc_md2-arquitetura">Arquitetura</a></li>
<li><a class="el" href="C:/Atividade2EBT/servidor_railway/README.md#autotoc_md3-tecnologias-utilizadas">Tecnologias Utilizadas</a></li>
<li><a class="el" href="C:/Atividade2EBT/servidor_railway/README.md#autotoc_md4-configuração-e-implantação">Configuração e Implantação</a><ul>
<li><a class="el" href="C:/Atividade2EBT/servidor_railway/README.md#autotoc_md41-pré-requisitos">Pré-requisitos</a></li>
<li><a class="el" href="C:/Atividade2EBT/servidor_railway/README.md#autotoc_md42-instalação-das-dependências">Instalação das Dependências</a></li>
<li><a class="el" href="C:/Atividade2EBT/servidor_railway/README.md#autotoc_md43-configuração-no-railway">Configuração no Railway</a></li>
</ul>
</li>
<li><a class="el" href="C:/Atividade2EBT/servidor_railway/README.md#autotoc_md5-endpoints-da-api">Endpoints da API</a></li>
<li><a class="el" href="C:/Atividade2EBT/servidor_railway/README.md#autotoc_md6-estrutura-dos-dados">Estrutura dos Dados</a></li>
<li><a class="el" href="C:/Atividade2EBT/servidor_railway/README.md#autotoc_md7-customização-e-extensão">Customização e Extensão</a></li>
<li><a class="el" href="C:/Atividade2EBT/servidor_railway/README.md#autotoc_md8-diagrama-de-deploy">Diagrama de Deploy</a></li>
</ol>
<hr  />
<h1><a class="anchor" id="autotoc_md1-visão-geral"></a>
1. Visão Geral</h1>
<p>O servidor backend é uma aplicação web construída com o microframework Flask em Python. Ele atua como um ponto central de comunicação entre os dispositivos Raspberry Pi Pico W e os dashboards web. O servidor recebe dados dos dispositivos via requisições HTTP POST, processa esses dados e os retransmite em tempo real para os clientes web (dashboards) utilizando WebSockets, através da biblioteca Flask-SocketIO.</p>
<h1><a class="anchor" id="autotoc_md2-arquitetura"></a>
2. Arquitetura</h1>
<p>A arquitetura do servidor é simples e modular:</p>
<ul>
<li><b>Flask:</b> Lida com o roteamento das requisições HTTP e o serviço de arquivos estáticos (HTML, CSS, JavaScript).</li>
<li><b>Flask-SocketIO:</b> Permite a comunicação bidirecional em tempo real entre o servidor e os clientes web.</li>
<li><b>Gunicorn (com Eventlet):</b> Servidor WSGI para implantação em produção, utilizando o worker Eventlet para compatibilidade com Socket.IO.</li>
</ul>
<div class="fragment"><div class="line">graph LR</div>
<div class="line">    A[Flask] --&gt; B(Flask-SocketIO)</div>
<div class="line">    A --&gt; C(Gunicorn)</div>
<div class="line">    C --&gt; D(Eventlet)</div>
<div class="line">    B -- WebSocket --&gt; E[Dashboards Web]</div>
<div class="line">    F[Raspberry Pi Pico W] -- HTTP POST --&gt; A</div>
<div class="line">    style A fill:#3776AB,stroke:#333,stroke-width:2px,color:#fff</div>
<div class="line">    style B fill:#007ACC,stroke:#333,stroke-width:2px,color:#fff</div>
<div class="line">    style C fill:#A22846,stroke:#333,stroke-width:2px,color:#fff</div>
<div class="line">    style D fill:#A22846,stroke:#333,stroke-width:2px,color:#fff</div>
<div class="line">    style E fill:#007ACC,stroke:#333,stroke-width:2px,color:#fff</div>
<div class="line">    style F fill:#A22846,stroke:#333,stroke-width:2px,color:#fff</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md3-tecnologias-utilizadas"></a>
3. Tecnologias Utilizadas</h1>
<ul>
<li><a href="https://www.python.org/">Python 3.8+</a></li>
<li><a href="https://flask.palletsprojects.com/">Flask</a>: Microframework web para Python.</li>
<li><a href="https://flask-socketio.readthedocs.io/">Flask-SocketIO</a>: Integração de Socket.IO com Flask.</li>
<li><a href="https://gunicorn.org/">Gunicorn</a>: Servidor WSGI para implantação.</li>
<li><a href="https://eventlet.net/">Eventlet</a>: Biblioteca para concorrência (necessária para Socket.IO com Gunicorn).</li>
</ul>
<h1><a class="anchor" id="autotoc_md4-configuração-e-implantação"></a>
4. Configuração e Implantação</h1>
<h2><a class="anchor" id="autotoc_md41-pré-requisitos"></a>
4.1. Pré-requisitos</h2>
<ul>
<li>Python 3.8 ou superior instalado.</li>
<li><code>pip</code> (gerenciador de pacotes Python).</li>
<li>Conta na plataforma <a href="https://railway.app/">Railway</a> (opcional, mas recomendado para implantação fácil).</li>
</ul>
<h2><a class="anchor" id="autotoc_md42-instalação-das-dependências"></a>
4.2. Instalação das Dependências</h2>
<p>Navegue até o diretório <code>/servidor_railway</code> e execute o seguinte comando para instalar as dependências:</p>
<div class="fragment"><div class="line">pip install -r requirements.txt</div>
</div><!-- fragment --><p>O arquivo <code>requirements.txt</code> deve conter as seguintes dependências:</p>
<div class="fragment"><div class="line">flask</div>
<div class="line">flask-socketio</div>
<div class="line">eventlet</div>
<div class="line">gunicorn</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md43-configuração-no-railway"></a>
4.3. Configuração no Railway</h2>
<p>Para implantar o servidor no Railway, siga estas etapas:</p>
<ol type="1">
<li><b>Crie uma conta</b> ou <b>faça login</b> na plataforma <a href="https://railway.app/">Railway</a>.</li>
<li>Selecione <b>New Project</b> e escolha <b>Deploy from GitHub repo</b>.</li>
<li>Selecione o repositório que contém o código do servidor.</li>
<li>O Railway detectará automaticamente o <code>Procfile</code> e configurará o deploy.</li>
<li>Não são necessárias variáveis de ambiente adicionais, mas você pode configurá-las caso precise de customizações específicas.</li>
<li>Clique em <b>Deploy</b> para iniciar o processo de implantação.</li>
</ol>
<p>O Procfile já está configurado para usar o Gunicorn com o worker Eventlet necessário para o Flask-SocketIO:</p>
<div class="fragment"><div class="line">web: gunicorn -k eventlet -w 1 <a class="code hl_namespace" href="namespaceapp.html">app</a>:<a class="code hl_namespace" href="namespaceapp.html">app</a></div>
<div class="ttc" id="anamespaceapp_html"><div class="ttname"><a href="namespaceapp.html">app</a></div><div class="ttdef"><b>Definição</b> app.py:1</div></div>
</div><!-- fragment --><p>Uma vez implantado, o Railway fornecerá um URL para acesso ao seu servidor.</p>
<h1><a class="anchor" id="autotoc_md5-endpoints-da-api"></a>
5. Endpoints da API</h1>
<p>O servidor disponibiliza os seguintes endpoints:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Endpoint   </th><th class="markdownTableHeadNone">Método   </th><th class="markdownTableHeadNone">Descrição    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>/dados</code>   </td><td class="markdownTableBodyNone">POST   </td><td class="markdownTableBodyNone">Recebe dados dos dispositivos Raspberry Pi Pico W    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>/dashboard/botoes</code>   </td><td class="markdownTableBodyNone">GET   </td><td class="markdownTableBodyNone">Interface web para visualização dos botões e temperatura    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>/dashboard/joystick</code>   </td><td class="markdownTableBodyNone">GET   </td><td class="markdownTableBodyNone">Interface web para visualização do joystick   </td></tr>
</table>
<h2><a class="anchor" id="detalhes-dos-endpoints"></a>
Detalhes dos Endpoints:</h2>
<h3><a class="anchor" id="post-dados"></a>
POST <code>/dados</code></h3>
<ul>
<li><b>Função:</b> Receber dados dos dispositivos IoT</li>
<li><b>Formato de entrada:</b> JSON</li>
<li><b>Exemplo de requisição:</b> <div class="fragment"><div class="line">{</div>
<div class="line">  &quot;button_a&quot;: 1,</div>
<div class="line">  &quot;button_b&quot;: 0,</div>
<div class="line">  &quot;temperature&quot;: 25.5</div>
<div class="line">}</div>
</div><!-- fragment --> ou <div class="fragment"><div class="line">{</div>
<div class="line">  &quot;x&quot;: 75,</div>
<div class="line">  &quot;y&quot;: 25</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li><b>Retorno:</b> <code>{"status": "ok"}</code> (HTTP 200) em caso de sucesso</li>
</ul>
<h1><a class="anchor" id="autotoc_md6-estrutura-dos-dados"></a>
6. Estrutura dos Dados</h1>
<p>O servidor trabalha com dois formatos principais de dados:</p>
<h2><a class="anchor" id="dados-dos-botões-e-temperatura"></a>
Dados dos Botões e Temperatura</h2>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;button_a&quot;: 0|1,         // 0=solto, 1=pressionado</div>
<div class="line">  &quot;button_b&quot;: 0|1,         // 0=solto, 1=pressionado</div>
<div class="line">  &quot;temperature&quot;: float     // Temperatura em graus Celsius</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="dados-do-joystick"></a>
Dados do Joystick</h2>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;x&quot;: int,    // Posição no eixo X (0-100)</div>
<div class="line">  &quot;y&quot;: int     // Posição no eixo Y (0-100)</div>
<div class="line">}</div>
</div><!-- fragment --><p>Os dados são enviados pelos dispositivos Raspberry Pi Pico W através de requisições HTTP POST e são armazenados temporariamente no servidor. Os clientes web recebem esses dados em tempo real via WebSockets.</p>
<h1><a class="anchor" id="autotoc_md7-customização-e-extensão"></a>
7. Customização e Extensão</h1>
<p>O servidor foi projetado para ser facilmente expansível. Algumas possibilidades de customização:</p>
<h2><a class="anchor" id="adição-de-novos-sensores"></a>
Adição de Novos Sensores</h2>
<p>Para adicionar um novo tipo de sensor:</p>
<ol type="1">
<li>Modifique a estrutura de dados no arquivo <code><a class="el" href="app_8py.html">app.py</a></code> para incluir o novo sensor na variável <code>ultimo_dado</code>.</li>
<li>Crie ou atualize os templates HTML em <code>/templates</code> para exibir os novos dados.</li>
<li>Adicione a lógica JavaScript necessária em <code>/static/js</code> para processar os dados do novo sensor.</li>
</ol>
<h2><a class="anchor" id="personalização-da-interface"></a>
Personalização da Interface</h2>
<p>Os estilos da interface estão separados nos arquivos CSS em <code>/static/css</code>:</p>
<ul>
<li><code>botoes.css</code> para a interface de botões e temperatura</li>
<li><code>joystick.css</code> para a interface do joystick</li>
</ul>
<p>Você pode modificar estes arquivos para personalizar a aparência das páginas.</p>
<h2><a class="anchor" id="implementação-de-autenticação"></a>
Implementação de Autenticação</h2>
<p>Para adicionar autenticação aos endpoints:</p>
<ol type="1">
<li>Instale o Flask-Login: <code>pip install flask-login</code></li>
<li>Adicione a configuração no arquivo <code><a class="el" href="app_8py.html">app.py</a></code></li>
<li>Crie uma página de login e atualize os endpoints para exigir autenticação</li>
</ol>
<h1><a class="anchor" id="autotoc_md8-diagrama-de-deploy"></a>
8. Diagrama de Deploy</h1>
<p>O diagrama abaixo mostra o fluxo completo de deploy e comunicação entre os componentes do sistema:</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    A[Código Fonte] --&gt;|Deploy| B[Railway Platform]</div>
<div class="line">    B --&gt;|Execução| C[Servidor Flask/SocketIO]</div>
<div class="line">    D[Raspberry Pi Pico W] --&gt;|HTTP POST /dados| C</div>
<div class="line">    C --&gt;|WebSocket| E[Dashboard Web - Botões]</div>
<div class="line">    C --&gt;|WebSocket| F[Dashboard Web - Joystick]</div>
<div class="line">    </div>
<div class="line">    subgraph &quot;Infraestrutura Railway</div>
<div class="line">    &quot;</div>
<div class="line">    B --&gt; G[Gunicorn]</div>
<div class="line">    G --&gt; H[Eventlet Worker]</div>
<div class="line">    H --&gt; C</div>
<div class="line">    end</div>
<div class="line">    </div>
<div class="line">    subgraph &quot;Cliente Web&quot;</div>
<div class="line">    E</div>
<div class="line">    F</div>
<div class="line">    end</div>
<div class="line">    </div>
<div class="line">    style A fill:#4CAF50,stroke:#333,stroke-width:2px,color:#fff</div>
<div class="line">    style B fill:#2196F3,stroke:#333,stroke-width:2px,color:#fff</div>
<div class="line">    style C fill:#3776AB,stroke:#333,stroke-width:2px,color:#fff</div>
<div class="line">    style D fill:#A22846,stroke:#333,stroke-width:2px,color:#fff</div>
<div class="line">    style E fill:#007ACC,stroke:#333,stroke-width:2px,color:#fff</div>
<div class="line">    style F fill:#007ACC,stroke:#333,stroke-width:2px,color:#fff</div>
<div class="line">    style G fill:#A22846,stroke:#333,stroke-width:2px,color:#fff</div>
<div class="line">    style H fill:#A22846,stroke:#333,stroke-width:2px,color:#fff</div>
</div><!-- fragment --><p>Este diagrama ilustra como os dados fluem desde o dispositivo Raspberry Pi Pico W até os dashboards web, passando pela infraestrutura do Railway que executa o servidor Flask com WebSockets. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_9f868f4f34704565cf1ffce8c4090011.html">servidor_railway</a></li>
    <li class="footer">Gerado por <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
